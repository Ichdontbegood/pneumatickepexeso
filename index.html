<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Schématické značky</title>
    <style>
      
        
        /* 1. Tmavé */
        :root {
            --bg-color: #1e293b;
            --text-color: #f1f5f9;
            --accent: #38bdf8;
            --accent-hover: #0ea5e9;
            --card-back: #334155; /* Tmavé pozadí kartičky */
            --correct: #22c55e;
            --wrong: #ef4444;
            --modal-bg: rgba(30, 41, 59, 0.95);
        }

        /* 2. Světlé */
        [data-theme="office"] {
            --bg-color: #f8fafc;
            --text-color: #1e293b;
            --accent: #2563eb;
            --accent-hover: #1d4ed8;
            --card-back: #e2e8f0;
            --correct: #16a34a;
            --wrong: #dc2626;
            --modal-bg: rgba(255, 255, 255, 0.95);
        }

        /* 3. Zelené */
        [data-theme="forest"] {
            --bg-color: #1a2e1a;
            --text-color: #ecfccb;
            --accent: #84cc16;
            --accent-hover: #65a30d;
            --card-back: #3f6212;
            --correct: #4ade80;
            --wrong: #ef4444;
            --modal-bg: rgba(26, 46, 26, 0.95);
        }

        /* 4. Béžové */
        [data-theme="retro"] {
            --bg-color: #fef3c7;
            --text-color: #78350f;
            --accent: #d97706;
            --accent-hover: #b45309;
            --card-back: #fde68a;
            --correct: #65a30d;
            --wrong: #b91c1c;
            --modal-bg: rgba(254, 243, 199, 0.95);
        }

        /* 5. Fialové */
        [data-theme="dracula"] {
            --bg-color: #2e1065;
            --text-color: #e9d5ff;
            --accent: #d8b4fe;
            --accent-hover: #c084fc;
            --card-back: #581c87;
            --correct: #4ade80;
            --wrong: #f43f5e;
            --modal-bg: rgba(46, 16, 101, 0.95);
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            transition: background-color 0.5s, color 0.5s;
        }

        /* --- UI PRVKY --- */
        .header-controls {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
            align-items: center;
        }

        select {
            padding: 8px;
            border-radius: 5px;
            border: 2px solid var(--accent);
            background: var(--bg-color);
            color: var(--text-color);
            cursor: pointer;
            font-weight: bold;
        }

        h1, h2 { text-align: center; color: var(--accent); margin-top: 20px; }

        .btn {
            background: linear-gradient(135deg, var(--accent), var(--accent-hover));
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.2rem;
            border-radius: 12px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            text-transform: uppercase;
            font-weight: bold;
            letter-spacing: 1px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            margin: 10px;
        }

        .btn:hover { transform: scale(1.05); filter: brightness(1.1); }
        .btn-secondary { background: var(--card-back); font-size: 1rem; padding: 10px 20px; color: var(--text-color); }

        /* --- LAYOUT HER --- */
        .menu-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-top: 15vh;
            animation: fadeIn 0.8s ease;
            text-align: center;
        }

        .game-section { display: none; width: 100%; max-width: 1200px; flex-direction: column; align-items: center; padding-bottom: 50px; }
        .game-section.active { display: flex; }

        .controls-bar {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }

        /* --- PEXESO --- */
        .pexeso-grid {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 15px;
            margin: 20px;
            perspective: 1000px;
        }

        .card {
            width: 110px;
            height: 110px;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.6s;
            cursor: pointer;
        }

        .card.flipped { transform: rotateY(180deg); }
        .card.matched { visibility: hidden; opacity: 0; transition: opacity 0.5s; }

        .card-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
            text-align: center;
            font-weight: bold;
            padding: 5px;
            box-sizing: border-box;
            font-size: 0.85rem;
        }

        .card-front {
            background-color: var(--card-back);
            color: var(--accent);
            font-size: 2rem;
            border: 2px solid var(--accent);
        }

        .card-back {
            background-color: #fff; /* Vždy bílé pozadí PRO OBRÁZEK PEXESA */
            color: #000;
            transform: rotateY(180deg);
            overflow: hidden;
            border: 2px solid var(--accent);
        }
        
        .card-back img { width: 90%; height: 90%; object-fit: contain; }

        /* --- SPOJOVAČKA --- */
        .matching-container {
            display: flex;
            justify-content: space-between;
            width: 90%;
            max-width: 900px;
            gap: 40px;
        }

        .col { display: flex; flex-direction: column; gap: 15px; flex: 1; }

        .match-item {
            /* ZDE JE OPRAVA: Barva pozadí se bere z tématu (např. tmavá), nikoliv bílá */
            background-color: var(--card-back); 
            padding: 15px;
            border-radius: 8px;
            cursor: pointer;
            border: 2px solid transparent;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            transition: 0.2s;
            user-select: none;
            overflow: hidden; 
        }

        .match-item:hover { border-color: var(--accent); }
        .match-item.selected { background-color: var(--accent) !important; color: white !important; transform: scale(1.02); }
        .match-item.correct { background-color: var(--correct) !important; border-color: var(--correct); opacity: 0.5; pointer-events: none; }
        .match-item.wrong { animation: shake 0.4s; border-color: var(--wrong); }

        /* Obrázek uvnitř tlačítka - žádná inverze, kulaté rohy pro hezčí vzhled na tmavém pozadí */
        .match-item img { 
            max-height: 50px;
            border-radius: 4px; 
            /* Žádný filtr = originální bílé pozadí JPG */
        }

        /* --- VYSKAKOVACÍ OKNO (MODAL) --- */
        .modal {
            display: none;
            position: fixed;
            z-index: 100;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background-color: var(--modal-bg);
            border: 2px solid var(--accent);
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            max-width: 400px;
            width: 90%;
            animation: popIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        
        .modal h2 { font-size: 2.5rem; margin: 0 0 20px 0; }
        .stats-text { font-size: 1.2rem; margin-bottom: 30px; line-height: 1.6; }

        /* --- ANIMACE A RESPONSIVITA --- */
        @media (max-width: 800px) {
            .pexeso-grid { grid-template-columns: repeat(4, 1fr); }
            .card { width: 70px; height: 70px; font-size: 0.6rem; }
            .matching-container { gap: 10px; }
            .match-item { font-size: 0.9rem; padding: 10px; }
            .header-controls { position: relative; top: 0; right: 0; margin-top: 10px; }
        }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes popIn { from { transform: scale(0.5); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-5px); } 75% { transform: translateX(5px); } }
    </style>
</head>
<body>

    <div class="header-controls">
        <label for="themeSelect">Téma: </label>
        <select id="themeSelect" onchange="changeTheme(this.value)">
            <option value="default">Tmavé</option>
            <option value="office">Světlé</option>
            <option value="forest">Zelené</option>
            <option value="retro">Béžové</option>
            <option value="dracula">Fialové</option>
        </select>
    </div>

    <div id="menu" class="menu-container">
        <h1>Pneumatiské schématické značky</h1>
        <div>
            <button class="btn" onclick="startGame('pexeso')">Pexeso</button>
            <button class="btn" onclick="startGame('matching')">Spojovačka</button>
        </div>
    </div>

    <div id="pexeso-game" class="game-section">
        <h2>Pexeso: Symbol & Název</h2>
        <div class="controls-bar">
            <button class="btn btn-secondary" onclick="restartGame()">Hrát znovu</button>
            <button class="btn btn-secondary" onclick="goBack()">Menu</button>
        </div>
        <div class="pexeso-grid" id="pexeso-board"></div>
    </div>

    <div id="matching-game" class="game-section">
        <h2>Spojovačka</h2>
        <div class="controls-bar">
            <button class="btn btn-secondary" onclick="restartGame()">Hrát znovu</button>
            <button class="btn btn-secondary" onclick="goBack()">Menu</button>
        </div>
        <div class="matching-container">
            <div class="col" id="left-col"></div>
            <div class="col" id="right-col"></div>
        </div>
    </div>

    <div id="gameOverModal" class="modal">
        <div class="modal-content">
            <h2>Výborně!</h2>
            <div id="modal-stats" class="stats-text">
                </div>
            <button class="btn" onclick="restartGame()">Hrát znovu</button>
            <button class="btn btn-secondary" onclick="goBack()">Zpět do menu</button>
        </div>
    </div>

    <script>
        // --- DATA ---
        const data = [
            { id: 1, name: "Dvojčinný pohon", img: "imgs/img1.jpg" },
            { id: 2, name: "Jednočinný pohon", img: "imgs/img2.jpg" },
            { id: 3, name: "Kompresor", img: "imgs/img3.jpg" },
            { id: 4, name: "Úprava vzduchu", img: "imgs/img4.jpg" },
            { id: 5, name: "Průchozí pístnice", img: "imgs/img5.jpg" },
            { id: 6, name: "Nastavitelné tlumení", img: "imgs/img6.jpg" },
            { id: 7, name: "Kyvný motor", img: "imgs/img7.jpg" },
            { id: 8, name: "Rotační motor", img: "imgs/img8.jpg" },
            { id: 9, name: "Zpětný ventil", img: "imgs/img9.jpg" },
            { id: 10, name: "Škrtící ventil", img: "imgs/img10.jpg" },
            { id: 11, name: "Manometr", img: "imgs/img11.jpg" },
            { id: 12, name: "Redukční ventil", img: "imgs/img12.jpg" }
        ];

        let currentGameType = '';
        let matchingMistakes = 0;
        let matchedPairsCount = 0;

        // --- PŘEPÍNÁNÍ TÉMAT ---
        function changeTheme(themeName) {
            if (themeName === 'default') {
                document.documentElement.removeAttribute('data-theme');
            } else {
                document.documentElement.setAttribute('data-theme', themeName);
            }
        }

        // --- NAVIGACE ---
        function startGame(type) {
            currentGameType = type;
            document.getElementById('menu').style.display = 'none';
            document.getElementById('gameOverModal').style.display = 'none';
            document.querySelectorAll('.game-section').forEach(el => el.classList.remove('active'));
            
            if (type === 'pexeso') {
                document.getElementById('pexeso-game').classList.add('active');
                initPexeso();
            } else {
                document.getElementById('matching-game').classList.add('active');
                initMatching();
            }
        }

        function restartGame() {
            startGame(currentGameType);
        }

        function goBack() {
            document.getElementById('gameOverModal').style.display = 'none';
            document.querySelectorAll('.game-section').forEach(el => el.classList.remove('active'));
            document.getElementById('menu').style.display = 'flex';
        }

        function showGameOver() {
            const modal = document.getElementById('gameOverModal');
            const statsDiv = document.getElementById('modal-stats');
            
            if (currentGameType === 'matching') {
                const totalPairs = data.length;
                const totalAttempts = totalPairs + matchingMistakes;
                const percentage = Math.round((totalPairs / totalAttempts) * 100);
                
                statsDiv.innerHTML = `
                    Hra dokončena!<br>
                    Počet chyb: <strong>${matchingMistakes}</strong><br>
                    Úspěšnost: <strong>${percentage}%</strong>
                `;
            } else {
                statsDiv.innerHTML = `Všechny páry nalezeny!`;
            }
            
            modal.style.display = 'flex';
        }

        // --- LOGIKA PEXESA ---
        function initPexeso() {
            const board = document.getElementById('pexeso-board');
            board.innerHTML = '';
            matchedPairsCount = 0;
            
            let cards = [];
            data.forEach(item => {
                cards.push({ id: item.id, type: 'text', content: item.name });
                cards.push({ id: item.id, type: 'img', content: `<img src="${item.img}" onerror="this.src='https://placehold.co/100?text=${item.id}'">` });
            });

            cards.sort(() => 0.5 - Math.random());

            let hasFlippedCard = false;
            let lockBoard = false;
            let firstCard, secondCard;

            cards.forEach(cardData => {
                const card = document.createElement('div');
                card.classList.add('card');
                card.dataset.id = cardData.id;

                card.innerHTML = `
                    <div class="card-face card-front">?</div>
                    <div class="card-face card-back">${cardData.content}</div>
                `;

                card.addEventListener('click', function() {
                    if (lockBoard || this === firstCard || this.classList.contains('flipped')) return;

                    this.classList.add('flipped');

                    if (!hasFlippedCard) {
                        hasFlippedCard = true;
                        firstCard = this;
                        return;
                    }

                    secondCard = this;
                    checkForMatch();
                });

                board.appendChild(card);
            });

            function checkForMatch() {
                let isMatch = firstCard.dataset.id === secondCard.dataset.id;
                isMatch ? disableCards() : unflipCards();
            }

            function disableCards() {
                matchedPairsCount++;
                firstCard.classList.add('matched');
                secondCard.classList.add('matched');
                resetBoard();
                
                // Kontrola konce hry
                if (matchedPairsCount === data.length) {
                    setTimeout(showGameOver, 500);
                }
            }

            function unflipCards() {
                lockBoard = true;
                setTimeout(() => {
                    firstCard.classList.remove('flipped');
                    secondCard.classList.remove('flipped');
                    resetBoard();
                }, 1000);
            }

            function resetBoard() {
                [hasFlippedCard, lockBoard] = [false, false];
                [firstCard, secondCard] = [null, null];
            }
        }

        // --- LOGIKA SPOJOVAČKY ---
        let selectedLeft = null;
        let selectedRight = null;

        function initMatching() {
            matchingMistakes = 0;
            matchedPairsCount = 0;
            const leftCol = document.getElementById('left-col');
            const rightCol = document.getElementById('right-col');
            leftCol.innerHTML = '';
            rightCol.innerHTML = '';

            let leftItems = [...data];
            let rightItems = [...data];

            rightItems.sort(() => 0.5 - Math.random());

            leftItems.forEach(item => {
                const el = createMatchCard(item, 'left');
                leftCol.appendChild(el);
            });

            rightItems.forEach(item => {
                const el = createMatchCard(item, 'right');
                rightCol.appendChild(el);
            });
        }

        function createMatchCard(item, side) {
            const el = document.createElement('div');
            el.classList.add('match-item');
            el.dataset.id = item.id;
            el.dataset.side = side;
            
            if(side === 'left') {
                 el.innerHTML = `<img src="${item.img}" onerror="this.style.display='none'; this.parentElement.innerText='Symbol ${item.id}'">`;
            } else {
                el.innerText = item.name;
            }
            
            el.addEventListener('click', handleMatchClick);
            return el;
        }

        function handleMatchClick(e) {
            const el = e.currentTarget;
            if (el.classList.contains('correct')) return;

            const side = el.dataset.side;

            if (side === 'left') {
                if (selectedLeft) selectedLeft.classList.remove('selected');
                selectedLeft = el;
            } else {
                if (selectedRight) selectedRight.classList.remove('selected');
                selectedRight = el;
            }
            el.classList.add('selected');

            if (selectedLeft && selectedRight) {
                checkPair();
            }
        }

        function checkPair() {
            if (selectedLeft.dataset.id === selectedRight.dataset.id) {
                // Správně
                selectedLeft.classList.add('correct');
                selectedRight.classList.add('correct');
                selectedLeft.classList.remove('selected');
                selectedRight.classList.remove('selected');
                selectedLeft = null;
                selectedRight = null;
                
                matchedPairsCount++;
                if (matchedPairsCount === data.length) {
                    setTimeout(showGameOver, 300);
                }
            } else {
                // Špatně
                matchingMistakes++;
                selectedLeft.classList.add('wrong');
                selectedRight.classList.add('wrong');
                setTimeout(() => {
                    if (selectedLeft) selectedLeft.classList.remove('wrong', 'selected');
                    if (selectedRight) selectedRight.classList.remove('wrong', 'selected');
                    selectedLeft = null;
                    selectedRight = null;
                }, 500);
            }
        }
    </script>
</body>
</html>
